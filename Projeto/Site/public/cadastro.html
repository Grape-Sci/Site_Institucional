<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="stylesheet" href="css/style-login-cadastro.css">
    <link rel="shortcut icon" type="imagex/png" href="img/icon.png">
</head>

<body>

    <div class="pagina" style="display: block;" id="div_cadastro">
        <div class="container">
            <div class="cadastro">
                <div class="imagemCad">
                    <div class="container" onclick="inicio()">
                        <img src="img/logo.png" alt="">
                    </div>
                </div>
                <div class="camposCad">
                    <div class="inputsCad1">
                        <div class="container">
                            <div class="campo">
                                <input type="text" id="input_usuario" placeholder="Usuário">
                            </div>
                            <div class="campo">
                                <input type="text" id="input_cnpj" placeholder="CNPJ">
                            </div>
                            <div class="campo">
                                <input type="text" id="input_telefone" placeholder="Telefone">
                            </div>
                            <div class="campo">
                                <input type="password" id="input_senha" placeholder="Senha">
                            </div>
                        </div>
                    </div>
                    <div class="inputsCad2">
                        <div class="container">
                            <div class="campo">
                                <input type="text" id="input_empresa" placeholder="Nome da empresa">
                            </div>
                            <div class="campo">
                                <input type="text" id="input_email" placeholder="Email">
                            </div>
                            <div class="campo">
                                <select id="select_cargo">
                                    <option value="0" selected disabled>Selecione seu cargo:</option>
                                    <option value="1">Gerente</option>
                                    <option value="2">Funcionário</option>
                                </select>
                            </div>
                            <div class="campo">
                                <input type="password" id="input_confirmar" placeholder="Confirmar senha">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="botaoCad">
                    <div class="container">
                        <button onclick="cadastrar()">Cadastrar</button>
                        <span>Já possui uma conta? <a href="login.html">Login</a></span>
                    </div>
                </div>
            </div>
        </div>
        <div id="msg_alertas" class="msg_alertas">
            <span class="ms" id="mensagem"></span>
        </div>
    </div>

    <div class="pagina" style="display: none;" id="div_confirmacao">
        <div class="container">
            <div class="confirmacaoCad">
                <div class="imagem">
                    <div class="container" onclick="inicioConf()">
                        <img src="img/logo.png" alt="">
                    </div>
                </div>
                <div class="campos">
                    <div class="container">
                        <div class="confirmacaoText">
                            <h3>Precisamos confirmar sua identidade!</h3>
                            <p>Insira o código enviado:</p>
                        </div>
                        <div class="campo">
                            <input type="text" placeholder="Código" id="input_codigo">
                        </div>
                    </div>
                </div>
                <div class="botao">
                    <div class="container">
                        <button onclick="enviar()">Enviar</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="msg_alertasConf" class="msg_alertas">
            <span class="ms" id="mensagemConf"></span>
        </div>
    </div>

</body>

</html>

<script>

    function cadastrar() {
        // Captura os valores dos campos do formulário
        var usuario = input_usuario.value;
        var cnpj = input_cnpj.value;
        var telefone = input_telefone.value;
        var senha = input_senha.value;
        var empresa = input_empresa.value;
        var email = input_email.value;
        var cargo = select_cargo.value;
        var confirmar = input_confirmar.value;
        var temErro = false; // Variável para rastrear erros de validação

        // Verifica se algum campo obrigatório está vazio
        if (usuario == "" || cnpj == "" || telefone == "" || senha == "" || empresa == "" || email == "" || cargo == 0 || confirmar == "") {
            // Exibe uma mensagem de erro e marca que há um erro
            msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `Preencha os campos corretamente`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        } else if (email.indexOf('@') < 0 && email.indexOf('.') < 0) { // Verifica se o e-mail é válido
            // Exibe uma mensagem de erro e marca que há um erro
            msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `Insira um e-mail válido`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        } else if (senha.length < 6) { // Verifica se a senha tem pelo menos 6 caracteres
            // Exibe uma mensagem de erro e marca que há um erro
            msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `A senha deve conter ao mínimo 5 caracteres`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        } else if (cnpj.length != 14) { // Verifica se o CNPJ tem 14 caracteres
            // Exibe uma mensagem de erro e marca que há um erro
            msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `Insira um CNPJ válido`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        } else if (senha != confirmar) { // Verifica se a senha e a confirmação de senha coincidem
            // Exibe uma mensagem de erro e marca que há um erro
            msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `Suas senhas estão diferentes`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        } else if (empresa != "UvaLTDA") {
             // Exibe uma mensagem de erro e marca que há um erro
             msg_alertas.style.display = "block";
            mensagem.classList.add("erro");
            mensagem.innerHTML = `Essa empresa não é valida`;
            temErro = true;
            desaparecerCard(); // Chama uma função para ocultar algum elemento HTML
        }


        // Se não houver erros, oculta o formulário de cadastro e exibe uma mensagem de confirmação
        if (cargo == 1) {
            if (temErro == false) {
                div_cadastro.style = 'display:none';
                div_confirmacao.style = 'display:block';
            }
        } else if (cargo == 2) {
            if (temErro == false) {
                msg_alertas.style.display = "block"
                mensagem.classList.add("ok")
                mensagem.innerHTML = `Redirecionando para o Login...`
                desaparecerCard()
                setTimeout(function () {
                    window.location = "login.html"
                }, 2000) 
            }
        }

        function desaparecerCard() {
            setTimeout(function () {
                msg_alertas.style.display = "none"
            }, 3000)
        }

    }


    function enviar() {
        var codigo = input_codigo.value

        if (codigo == 'A1B2C3') {
            msg_alertasConf.style.display = "block"
            mensagemConf.classList.add("ok")
            mensagemConf.innerHTML = `Redirecionando para o Login...`
            desaparecerCard()
            setTimeout(function () {
                window.location = "login.html"
            }, 2000)
        } else {
            msg_alertasConf.style.display = "block"
            mensagemConf.classList.add("erro")
            mensagemConf.innerHTML = `Código de confirmação inválido`
            desaparecerCardConf()
        }
    }

    function desaparecerCard() {
        setTimeout(function () {
            msg_alertas.style.display = "none"
        }, 3000)
    }

    function desaparecerCardConf() {
        setTimeout(function () {
            msg_alertasConf.style.display = "none"
        }, 3000)
    }

    function inicio() {
        window.location = 'Inicio.html';
    }

    function inicioConf() {
        window.location = 'Inicio.html';
    }
</script>